<core:FragmentDefinition xmlns:macros="sap.fe.macros"
    xmlns="sap.m"
    xmlns:f="sap.ui.layout.form"
    xmlns:l="sap.ui.layout"
    xmlns:core="sap.ui.core">
    <Dialog contentWidth="50%" showHeader="true" id="id_AddNewSystems" draggable="true">
        <customHeader>
            <Bar>
                <contentLeft>
                    <Title level="H4" titleStyle="H4" text="{i18n>Systems}" class="MM_Title"/>
                </contentLeft>
                <contentRight>
                    <Button icon="sap-icon://decline" type="Default" class="MM_BtnDefault" press="onCancelAddSystem"></Button>
                </contentRight>
            </Bar>
        </customHeader>
        <content>
            <f:Form>
                <f:layout>
                    <f:ResponsiveGridLayout labelSpanXL="3" labelSpanL="3" labelSpanM="3" labelSpanS="12" adjustLabelSpan="false" columnsXL="1" columnsL="1" columnsM="1" singleContainerFullSize="false" />
                </f:layout>
                <f:formContainers>
                    <f:FormContainer binding="{MaterialDetails>/SystemData/newSystemData}">
                        <f:formElements>
                            <f:FormElement label="{i18n>system}" visible="{= ${MaterialDetails>/SystemData/newSystemData/scenario} === 'add'}">
                                <f:fields>
                                    <ComboBox class="MM_ComboBox" placeholder="{i18n>selectSystem}" selectedKey="{MaterialDetails>MM_SYSTEM_ID}" 
                                    items="{MaterialDetails>/SystemData/listofFilteredSystems}" valueState="{MaterialDetails>valueState/MM_SYSTEM_ID}" 
                                    showSecondaryValues="true" filterSecondaryValues= "false" selectionChange="onSelectNewSystemId" change="fnHandleComboboxValidation">
                                        <core:ListItem key="{MaterialDetails>MM_KEY}" text="{MaterialDetails>MM_SYSTEM_REF_LIST_DESC}"/>
                                    </ComboBox>
                                </f:fields>
                            </f:FormElement>
                            <f:FormElement label="{i18n>system}" visible="{= ${MaterialDetails>/SystemData/newSystemData/scenario} !== 'add'}">
                                <f:fields>
                                    <Input value="{parts:['MaterialDetails>MM_SYSTEM_ID', 'LookupModel>/MM_SYSTEM_REF_LIST'],formatter: '.formatter.getSystemText'}" editable="false" class="MM_InputText" />
                                </f:fields>
                            </f:FormElement>
                            <f:FormElement label="{i18n>targetSystemMaterialId}">
                                <f:fields>
                                    <Input value="{MaterialDetails>MM_TARGET_SYSTEM_MATERIAL_ID}" class="MM_InputText" placeholder="{i18n>enterTargetSystemMaterialID}" editable="{MaterialDetails>targetFieldsEditable}"/>
                                </f:fields>
                            </f:FormElement>
                            <f:FormElement label="{i18n>targetSystemMaterialTypeId}">
                                <f:fields>
                                    <ComboBox selectedKey="{MaterialDetails>MM_TARGET_SYSTEM_MATERIAL_TYPE_ID}" class="MM_ComboBox" placeholder="{i18n>selectTargetSystemMaterialType}" items="{LookupModel>/materialType}" showSecondaryValues="true" filterSecondaryValues= "true" change="fnHandleComboboxValidation" editable="{MaterialDetails>targetFieldsEditable}">
                                        <core:ListItem key="{LookupModel>MM_KEY}" text="{LookupModel>MM_MATERIAL_TYPE_SAP_CODE} - {LookupModel>MM_MATERIAL_TYPE_DESCRIPTION}"/>
                                    </ComboBox>
                                </f:fields>
                            </f:FormElement>
                        </f:formElements>
                    </f:FormContainer>
                </f:formContainers>
            </f:Form>
        </content>
        <footer>
            <OverflowToolbar>
                <ToolbarSpacer/>
                <Button text="{i18n>Add}" type="Emphasized" class="MM_BtnEmphasized" visible="{= ${MaterialDetails>/SystemData/newSystemData/scenario} === 'add'}" press="fnAddNewSystemData"></Button>
                <Button text="{i18n>Update}" type="Emphasized" class="MM_BtnEmphasized" visible="{= ${MaterialDetails>/SystemData/newSystemData/scenario} !== 'add'}" press="fnUpdateExistingSystemData"></Button>
            </OverflowToolbar>
        </footer>
    </Dialog>
</core:FragmentDefinition>